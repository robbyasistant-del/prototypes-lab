<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Guess the Mon Daily</title>
  <style>
    :root{--bg:#0a1022;--panel:#131d3d;--line:#334d88;--txt:#ecf3ff;--muted:#9cb2de;--ok:#22c55e;--bad:#ef4444;--acc:#7dc2ff}
    *{box-sizing:border-box}
    body{margin:0;font-family:Inter,Segoe UI,Arial;background:radial-gradient(1100px 700px at 20% -10%,#223a73 0%,var(--bg) 60%);color:var(--txt);padding:18px;min-height:100vh}
    .wrap{max-width:960px;margin:0 auto;display:grid;gap:12px}
    .panel{background:linear-gradient(180deg,#121d3d,#0d1733);border:1px solid #2d467f;border-radius:16px;padding:14px;box-shadow:0 12px 30px #0007}
    h1{margin:0 0 4px}.muted{color:var(--muted)}
    .top{display:flex;justify-content:space-between;align-items:center;gap:8px;flex-wrap:wrap}
    .hud{display:flex;gap:8px;flex-wrap:wrap}.pill{border:1px solid var(--line);background:#15254e;border-radius:999px;padding:6px 10px;font-weight:700}
    .btn{border:none;border-radius:10px;padding:10px 13px;font-weight:800;background:linear-gradient(180deg,#8fd5ff,#5cb7ff);color:#05101f;cursor:pointer}
    .btn.ghost{background:#182954;color:#d7e6ff;border:1px solid #35538f}
    .arena{display:grid;grid-template-columns:1.1fr .9fr;gap:12px}
    .silhouette{height:280px;border:1px solid #35508d;border-radius:14px;background:linear-gradient(180deg,#1a2a58,#101b3a);display:flex;align-items:center;justify-content:center;position:relative;overflow:hidden}
    .sil-svg{width:240px;height:240px;filter:drop-shadow(0 0 20px #000);transform:rotate(var(--rot,0deg)) scale(var(--sc,1));transition:.25s}
    .sil-path{fill:#05070d;transition:fill .25s ease}
    .sil-svg.reveal .sil-path{fill:url(#gradReveal)}
    .name{position:absolute;bottom:10px;left:10px;padding:6px 10px;border-radius:999px;background:#0d1738;border:1px solid #2e467f;font-weight:700}
    .q{display:grid;gap:8px}
    .answers{display:grid;grid-template-columns:1fr 1fr;gap:8px}
    .ans{border:1px solid #3a5797;background:#13244d;color:#e8f1ff;border-radius:10px;padding:10px;cursor:pointer;font-weight:700;text-align:left}
    .ans:hover{background:#1a3270}
    .ans.good{background:#1f6b43;border-color:#2ea866}.ans.bad{background:#6a2332;border-color:#b63e59}
    .status{padding:8px 10px;border-radius:10px;border:1px solid #31508e;background:#122046;min-height:42px;display:flex;align-items:center;font-weight:700}
    .status.win{border-color:#1f7a44;color:#b9ffd0}.status.lose{border-color:#9a3048;color:#ffd1db}
    .tiny{font-size:12px;color:#9db4df}
    @media (max-width:860px){.arena{grid-template-columns:1fr}.silhouette{height:240px}}
  </style>
</head>
<body>
<div class="wrap">
  <section class="panel">
    <div class="top">
      <div>
        <h1>ğŸ¯ Guess the Mon Daily</h1>
        <div class="muted">Silueta + trivia speedrun (8 rondas). Responde rÃ¡pido para multiplicador y streak.</div>
      </div>
      <div>
        <button class="btn" id="startBtn">Start Daily Run</button>
        <button class="btn ghost" id="shareBtn">Share Card</button>
      </div>
    </div>
    <div class="hud" style="margin-top:8px">
      <div class="pill">â± <span id="time">90</span>s</div>
      <div class="pill">ğŸ Ronda <span id="round">0</span>/8</div>
      <div class="pill">â­ Score <span id="score">0</span></div>
      <div class="pill">ğŸ”¥ Streak <span id="streak">0</span></div>
      <div class="pill">ğŸ† Best <span id="best">0</span></div>
    </div>
  </section>

  <section class="panel arena">
    <div class="silhouette">
      <svg id="silSvg" class="sil-svg" viewBox="0 0 240 240" aria-label="silueta">
        <defs>
          <linearGradient id="gradReveal" x1="0" y1="0" x2="0" y2="1">
            <stop offset="0%" stop-color="#ffe08a"/>
            <stop offset="100%" stop-color="#ffc247"/>
          </linearGradient>
        </defs>
        <path id="silPath" class="sil-path" d="M40 170 Q60 95 120 90 Q175 98 195 170 Q165 205 120 206 Q72 205 40 170 Z"/>
      </svg>
      <div id="nameTag" class="name">Â¿QuiÃ©n es este Mon?</div>
    </div>
    <div class="q">
      <div class="tiny">Pregunta actual</div>
      <h3 id="question" style="margin:0 0 4px">Pulsa Start para comenzar</h3>
      <div id="answers" class="answers"></div>
      <div id="status" class="status">Tip: +10 base, +bonus por velocidad, combo por aciertos seguidos.</div>
      <div class="tiny">Formato pensado para clips: reveal + score + share final.</div>
    </div>
  </section>
</div>

<script>
const SIL = {
  pika: 'M42 166 L58 112 L38 76 L74 84 L96 42 L118 82 L146 56 L142 96 L186 104 L166 126 L196 164 Q158 208 120 206 Q78 206 42 166 Z',
  char: 'M58 174 Q66 126 100 98 Q130 74 152 86 Q170 95 172 118 Q175 136 160 152 Q174 165 174 182 Q166 202 138 204 Q112 205 92 194 Q70 190 58 174 Z',
  squir: 'M54 164 Q56 122 88 102 Q120 82 152 98 Q178 112 182 144 Q183 170 166 186 Q146 205 114 204 Q86 204 68 188 Q54 176 54 164 Z',
  bulb: 'M50 170 Q58 124 94 102 Q126 84 150 98 Q182 118 186 154 Q188 174 174 190 Q154 206 116 206 Q82 204 62 188 Q50 178 50 170 Z M96 92 Q116 58 146 60 Q152 86 136 102 Z',
  eevee: 'M48 170 Q56 130 88 102 Q114 82 140 86 Q166 92 178 116 Q188 138 182 160 Q174 186 148 198 Q120 208 90 200 Q60 190 48 170 Z',
  luca: 'M56 176 L72 132 L96 90 L120 108 L144 86 L168 124 L182 170 Q154 206 122 206 Q86 206 56 176 Z',
  geng: 'M44 170 Q52 118 94 94 Q128 76 160 96 Q192 120 196 162 Q188 190 160 200 Q126 210 88 204 Q58 198 44 170 Z',
  snor: 'M44 170 Q46 126 86 102 Q122 84 156 100 Q190 118 196 162 Q194 188 170 202 Q148 212 120 212 Q84 210 62 194 Q44 184 44 170 Z',
  gard: 'M64 178 Q76 132 108 104 Q132 82 150 88 Q166 98 170 124 Q174 150 160 172 Q146 194 120 206 Q92 204 76 194 Q64 188 64 178 Z',
  drag: 'M44 174 Q58 126 96 96 Q130 72 162 90 Q188 108 196 142 Q202 172 184 194 Q162 212 126 212 Q88 210 62 194 Q48 186 44 174 Z'
};

const DB=[
 {name:'PIKACHU',type:'Electrico',region:'Kanto',evo:'Raichu',shape:{rot:'-8deg',sc:'1.02',sil:'pika'}},
 {name:'CHARMANDER',type:'Fuego',region:'Kanto',evo:'Charmeleon',shape:{rot:'16deg',sc:'0.96',sil:'char'}},
 {name:'SQUIRTLE',type:'Agua',region:'Kanto',evo:'Wartortle',shape:{rot:'-16deg',sc:'0.92',sil:'squir'}},
 {name:'BULBASAUR',type:'Planta',region:'Kanto',evo:'Ivysaur',shape:{rot:'10deg',sc:'1.06',sil:'bulb'}},
 {name:'EEVEE',type:'Normal',region:'Kanto',evo:'Vaporeon/Jolteon/Flareon',shape:{rot:'-20deg',sc:'0.9',sil:'eevee'}},
 {name:'LUCARIO',type:'Lucha/Acero',region:'Sinnoh',evo:'-',shape:{rot:'20deg',sc:'1.0',sil:'luca'}},
 {name:'GENGAR',type:'Fantasma/Veneno',region:'Kanto',evo:'-',shape:{rot:'-2deg',sc:'1.08',sil:'geng'}},
 {name:'SNORLAX',type:'Normal',region:'Kanto',evo:'-',shape:{rot:'4deg',sc:'1.18',sil:'snor'}},
 {name:'GARDEVOIR',type:'Psiquico/Hada',region:'Hoenn',evo:'-',shape:{rot:'-14deg',sc:'1.0',sil:'gard'}},
 {name:'DRAGONITE',type:'Dragon/Volador',region:'Kanto',evo:'-',shape:{rot:'12deg',sc:'1.1',sil:'drag'}},
];

const startBtn=document.getElementById('startBtn');
const shareBtn=document.getElementById('shareBtn');
const timeEl=document.getElementById('time');
const roundEl=document.getElementById('round');
const scoreEl=document.getElementById('score');
const streakEl=document.getElementById('streak');
const bestEl=document.getElementById('best');
const silSvg=document.getElementById('silSvg');
const silPath=document.getElementById('silPath');
const nameTag=document.getElementById('nameTag');
const questionEl=document.getElementById('question');
const answersEl=document.getElementById('answers');
const statusEl=document.getElementById('status');

let timer=null,lastTick=0,timeLeft=90;
let round=0,score=0,streak=0;
let queue=[],current=null,phase='idle';
const ROUNDS=8;

function pickN(arr,n){const a=[...arr];for(let i=a.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[a[i],a[j]]=[a[j],a[i]]}return a.slice(0,n)}
function setStatus(t,c=''){statusEl.className='status'+(c?' '+c:'');statusEl.textContent=t}
function updateHUD(){timeEl.textContent=Math.max(0,timeLeft).toFixed(1);roundEl.textContent=round;scoreEl.textContent=score;streakEl.textContent=streak;bestEl.textContent=localStorage.getItem('gtm_best')||0}

function startTimer(){clearInterval(timer);lastTick=performance.now();timer=setInterval(()=>{const now=performance.now();const dt=(now-lastTick)/1000;lastTick=now;timeLeft=Math.max(0,timeLeft-dt);updateHUD();if(timeLeft<=0) endRun(false)},50)}
function stopTimer(){clearInterval(timer);timer=null}

function buildQuestion(mon){
  const mode = Math.random()<0.65?'name':'trivia';
  if(mode==='name'){
    const opts=pickN(DB.filter(x=>x.name!==mon.name),3).map(x=>x.name);
    opts.push(mon.name);
    return {q:'Â¿QuiÃ©n es este Mon?',correct:mon.name,options:pickN(opts,4)};
  }
  const f = Math.random()<0.5?'type':'region';
  const correct=mon[f];
  const opts=pickN([...new Set(DB.map(x=>x[f]).filter(x=>x!==correct))],3);
  opts.push(correct);
  return {q: f==='type' ? `Â¿CuÃ¡l es el tipo de ${mon.name}?` : `Â¿De quÃ© regiÃ³n es ${mon.name}?`, correct, options:pickN(opts,4)};
}

function renderQ(){
  if(!current) return;
  questionEl.textContent=current.q.q;
  answersEl.innerHTML='';
  current.q.options.forEach(opt=>{
    const b=document.createElement('button');b.className='ans';b.textContent=opt;
    b.onclick=()=>answer(opt,b);
    answersEl.appendChild(b);
  });
}

function nextRound(){
  if(round>=ROUNDS){endRun(true);return}
  if(!queue.length) queue=pickN(DB,ROUNDS);
  current={mon:queue.shift()};
  current.q=buildQuestion(current.mon);
  round++;
  silSvg.style.setProperty('--rot',current.mon.shape.rot);silSvg.style.setProperty('--sc',current.mon.shape.sc);
  silPath.setAttribute('d', SIL[current.mon.shape.sil] || SIL.pika);
  silSvg.classList.remove('reveal');
  nameTag.textContent='Â¿QuiÃ©n es este Mon?';
  renderQ();
  updateHUD();
}

function answer(opt,btn){
  if(phase!=='run') return;
  const good = opt===current.q.correct;
  [...answersEl.children].forEach(x=>x.disabled=true);
  if(good){
    const speedBonus=Math.max(0,Math.floor(timeLeft/8));
    streak++; score += 10 + speedBonus + Math.min(20, streak*2);
    btn.classList.add('good');
    silSvg.classList.add('reveal');
    nameTag.textContent=current.mon.name;
    setStatus(`âœ… ${current.mon.name}. +${10+speedBonus+Math.min(20, streak*2)} pts`, '');
  }else{
    streak=0; timeLeft=Math.max(0,timeLeft-3);
    btn.classList.add('bad');
    const ok=[...answersEl.children].find(x=>x.textContent===current.q.correct); if(ok) ok.classList.add('good');
    setStatus(`âŒ Era: ${current.q.correct}. PenalizaciÃ³n -3s`, '');
  }
  updateHUD();
  setTimeout(nextRound,900);
}

function startRun(){
  phase='run'; timeLeft=90; round=0; score=0; streak=0; queue=[]; updateHUD();
  setStatus('Run iniciada. 8 rondas, responde rÃ¡pido.', '');
  startTimer();
  nextRound();
}

function endRun(completed){
  if(phase!=='run') return;
  phase='end'; stopTimer();
  const best=Number(localStorage.getItem('gtm_best')||0);
  if(score>best) localStorage.setItem('gtm_best', String(score));
  updateHUD();
  setStatus(completed?`ğŸ† Run completa: ${score} pts`:`âŒ› Tiempo agotado: ${score} pts`, completed?'win':'lose');
  questionEl.textContent='Run terminada. Pulsa Start para otra.';
  answersEl.innerHTML='';
  nameTag.textContent='Resultados listos para compartir';
}

function shareCard(){
  const txt = `ğŸ¯ Guess the Mon Daily\nScore: ${score}\nRondas: ${round}/${ROUNDS}\nStreak: ${streak}\nÂ¿Me superas?`;
  navigator.clipboard?.writeText(txt);
  setStatus('ğŸ“‹ Share card copiada al portapapeles.', '');
}

startBtn.onclick=startRun;
shareBtn.onclick=shareCard;
updateHUD();
</script>
</body>
</html>